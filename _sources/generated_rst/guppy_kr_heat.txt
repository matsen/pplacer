:tocdepth: 3

.. _guppy_kr_heat:

=======
kr_heat
=======

`kr_heat` makes a heat tree.

::

  usage: heat [options] placefile1 placefile2

Options
=======

--point-mass  Treat every pquery as a point mass concentrated on the highest-weight placement.
--pp  Use posterior probability for the weight.
-c  Reference package path.
-p  Exponent for KR integration, i.e. value of p in Z_p. Default 1.
--min-fat  The minimum branch length for fattened edges (to increase their visibility). To turn off set to 0. Default: 0.01
--total-width  Set the total pixel width for all of the branches of the tree. Default: 300
--width-factor  Override total-width by directly setting the number of pixels per unit of thing displayed.
--node-numbers  Put the node numbers in where the bootstraps usually go.
--gray-black  Use gray/black in place of red/blue to signify the sign of the coefficient for that edge.
--min-width  Specify the minimum width for a branch to be colored and thickened. Default is 1.
-o  Specify the filename to write to.
--out-dir  Specify the directory to write files to.
--prefix  Specify a string to be prepended to filenames.

Details
=======

Draw a "heat tree" in phyloXML format.
A heat tree shows the optimal movement of dirt in the "earth movers" interpretation of the Kantorovich-Rubinstein distance.
Imagine that the dirt is moving from the placement distribution corresponding to the first place file to that in the second.
The branches are thickened in proportion to the amount of dirt which moves through that edge.
Dirt moving on an edge towards the root is marked in red, and that moving away from the root is colored in blue.
Said another way, clades which are highly represented in the first sample but not the second are colored red, and the others blue.

